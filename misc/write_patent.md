# 专利写作

## 专利的组成

申请专利需要的材料由三部分组成：

* 权利要求书：申明专利需要保护的权利，理论上要求内容条理清晰、用次明确、毫无歧义，可以描述清楚所有权利的细节
* 专利说明书：描述一下专利的内容，然后通过一个案例分析，描述专利各个技术细节，对遣词造句要求较低
* 专利说明书附图：专利说明书涉及到的图片

## 专利不是技术报告

需要注意一点，专利不是技术报告。
技术报告是我们写给同行看的，反映我们工作解决了哪些问题，提出了那些技术，每个技术是怎么实现的等等，
我们习惯于用自己领域的专业词汇，习惯于自己领域的描述方式和思维方式，
因为我们一般认为，我们的同行默认有深刻的背景和相似的技术路线，可以快速同步我们的思维节奏。
但是专利不是这样子的。我对接的专利负责人习惯于把专利称为“案子”，
也就是专利本质上是一个法务文件，是给律师和法官看的，是在有利益纠纷的时候明晰自己的权利范围用的。
如果我们的缀词不够严谨准确，比如自己定义概念、比如范围比较模糊，就可以预见在有法律纠纷的时候，难以准确定义自己的权利。
此外，如果我们的表述方式过于技术化、领域化、专业化，
比如专有名词太生僻、思考方式太学科化，也会导致审理案件的司法人员不知所云，这也是不合适的。

## 权利要求书

### 申请权利的主体

现在我们完成了 dejavuzz，请问一下哪些东西可以作为我们的专利内容：

* 我们写的 razzle、starship-parafuzz、yosys-ift 等若干个仓库的代码
* 我们发表的论文
* 我们提出了基于污点覆盖率的突变引导技术
* 我们实现了污点插桩工具
* ...

我们习惯于认为我们制造的具体的劳动产物是我们的专利内容，比如我们写的代码、我们造的工具、我们造的杯子。
这时我们专利要保护的东西吗？当然是了，我们的劳动产物自然是要被保护起来的，但是仅仅保护我们具体的产物，这样做是存在漏洞的。

如果仅仅我们写的具体的代码是被保护的，那可能他直接执行我们写的代码是违法的，他 copy 我们写的代码去执行也是违法的，
但是如果人家抄袭我们的技术重新写了一份代码，甚至有了其他的语言或者实现方式，
那么从这个定义来看，他用的代码是他自己写的，和我的代码在形式上大相径庭，
那就不是我们写的那个“具体”的代码了，那从这个层面上来说其实就不违法了。
这和我们的常识其实是违反的，我们认为专利是保护我们的知识产权，如果对方剽窃了我们的创意那么就是违法的。
所以专利保护的核心不是我们具体的产物或者代码，而是我们产物和代表所代所代表的创意和设计思路。

因此，我们权利要求书要求被保护的权利不应该是具体的产物，而应该是抽象的新技术、新方法。
具体的产物被保护了，抽象的技术方法并没有被保护；
但是抽象的技术方法被保护了，非但具体产物这个应用了技术方法的实体被保护了，
将来其他人使用我们的技术方法实现的其他实体也会被我们的专利保护起来。
因此我们的专利保护对象是：“一种基于污点追踪的RISCV处理器瞬态执行漏洞检测的模糊测试方法”

### 面向过程的描述方式

我们的专利是一种“xxx的方法”，现在我们需要对这个方法进行定义，
定义的方式就是把方法的各个细节描述清楚，但是怎么做呢？

方法其实就是一个流程步骤，先怎么样，再怎么样，最后怎么样，也就是我们熟悉的 IPO 的描述方法。
但是我们的工作很多时候是将这个方法写成对应的代码，然后用这个代码工具去解决一个问题。
所以我们习惯性地会用描述代码的思路，去描述这个“技术方法”。
再加上我们在编程的时候自然而然的会用 OOP 和 divide and conquer 的设计方法，
因此我们很喜欢把代码且分为若干个子模块，分别介绍每个子模块的内容，然后再把这些模块统一起来。

往往是：

* 我们的方法由 A、B、C、D 四部分组成
* A 模块负责，B 模块负责，C 模块负责....
* A 产生 xx 给 B，B 对数据做什么操作给 C，C做什么操作给 D

这个描述方法对于我们计算机从业人员来说其实是和 IPO 高度统一的。
特别是第三点就是典型的 IPO，这不过每个子模块内部的操作过程是在介绍这个子模块的时候展开介绍的。
这用来介绍技术是一个很好的方法，不但模块细致，而且层次分明、详略得当，非常利于同行之间分享学习。
但是这不利于专利保护。

模块化其实是面向数据的，我们会把关联紧密的功能和数据继承在一个模块当中。
例如我们的步骤是 1-2-3-...-12,最好就是从步骤 1 描述到步骤 12，
但是我们发现步骤 3 和步骤 9 都是针对一个数据的，所以模块会把步骤 3 和步骤 9 集成到一起，
这在单纯描述步骤的时候其实会比较乱，一个模块会到处出现。
其次，模块的区分是不唯一的，一个方法不会因为你换了一个模块设计的方式就改变他的方法本质，
所以用模块来进行方法的描述，只会引入很多多余的概念和一些不唯一性。
最后，也是我个人觉得最重要的，那些司法人员不是计算机从业人员，他们没有 OOP 的思维，
我们的面向模块的写法他们估计看不懂，就不要难为他们了，难为他们就是难为我们自己。

所以请用面向过程的步骤化的语言进行描述，描述方法大致如下：

* 步骤 1：对数据 A 经过 xx 操作得到数据 B
* 步骤 2：对数据 B 经过 xx 操作得到数据 C
* ...

依次类推

我们讲一下这个写法的细节，都是为了描述的准确性准备的：

* 每个句子都是 IPO 形式的，“数据 A”经过“操作 xx”得到“数据 B”
* 这里的“对数据 A 经过 xx 操作得到数据 B”都是以一个缺省主语开始的，这个主语是指执行我们方法的对象，比如人，比如处理器。我们很多时候说代码对数据做操作，这是错误的；代码是方法的描述语言，其实是处理器根据代码的指令序列做数据操作，再进一步的就是处理器根据我们的方法在做数据操作。所以本质上就是任何用我们方法的实体在进行操作。
* 数据 A、B、C 和操作 xx 的内容要尽可能明确，不要由歧义性
* 第 i 步的输入如果是前面步骤出现过的输出，那么输入输出的名字必须保持完全一致
* 不要用大约、好像、大概、基本这些有歧义的词汇

这个流程组成了权利要求书的权利 1,是权利要求书中最重要的权利，也是专利中最重要的权利。

### 内容的细化

很多时候数据 A、操作 xx 不是一句话两句话可以描述清楚的，可能是因为他们的严格定义很复杂，也可能是因为这里面包含了我们独到的技术细节，需要作为重点强调的权利细节进行描述。这些细节在权利 1 中难以展开，我们可以在后续编写权利 2、权利 3 进行更详细的补充。

这些细化权利的描述方法格式一般为：
```
根据权利要求 1 所述的 xxx 方法，其特征在于，所述的步骤 xx /数据 A 具体为：
```
然后具体展开。

如果是步骤，可以写更详细的步骤 1、2、3；如果是数据可以写更详细的定义。
我们对于新的技术点很喜欢解释这么做的原因和好处，比如我们的数据是啥啥，这样定义有利于啥啥啥，
但是别人其实不在于你的好处是什么，这些主观的东西不会细化我们的专利特征，删了省字数。

如果后续的权利要求还要继续展开，可以针对这些子权利递归的写更细化的权利要求。
但是要注意权利要求不能超过 10 条，且每一条语句要尽量凝练，在意思明确的前提下，越短越好。
写的越多越难保证准确性。

### 虚拟装置和物理实体

当我们写执行过程的时候，难免会用到一些工具，工具为我们 IPO 的 P 提供支撑，
比如“用锤子把钉子砸入木板”，“砸入”这个过程需要“锤子”这个工具提供。
但是在专利中不是所有我们日常生活中所说的工具都是可以写的工具的。
我们日常生活中的工具分为物理实体和虚拟装置。
物理实体是看得见、摸的着的，比如杯子、板子、处理器、人。
而所有的软件本质上都是一种虚拟装置，都是看不见摸不着的。

我们在描述过程的时候说 IPO，物理实体可以作为 I 和 O，也可以提供 P；
而软件、计算机里面的数据可以作为 I 和 O，但是不能提供 P。
比如说，我们会说，用编译器编译源代码得到可执行程序，
看起来源代码就是 I，可执行程序就是 O，编译就是 P，编译器就是编译的提供者。
但是实际上编译器只是一个指令序列，是处理器根据编译器的指令序列对源代码进行编译处理，
所以处理器才是编译的提供者，而不是“编译器”。
加载编译程序的编译器才是编译的装置，才是真正的“编译器”；
而我们所谓的可以做什么什么操作的“编译器”只是编译器软件，只是一个我们抽象出来的一个虚拟装置而已。

而且用“编译器编译”这个过程其实是不安全的表述。
源代码和可执行程序是没有歧义，所以 I 源代码到 O 可执行程序的映射是没有歧义的，这个映射 P 编译也就是没有歧义的。
但是“用编译器”编译就不是了，一方面它是 IPO 之外多余的部分，一方面我可以不用编译器软件编译，我可以用算盘珠子编译嘛。
所以在描述数据操作过程的时候，尽量避免使用这些软件指代的虚拟装置。
但是也不绝对，比如浏览器、防火墙这些都是深入人心的术语，就算在逻辑学上存在争议，
但是已经日常生活的一部分了，那还是可以格外开恩的，毕竟合同有二义性的时候，尊重大众解释。

当我们的方法需要用到特殊工具，或者说特殊装置的时候，需要在方面流程开头对这些装置进行额外的描述。
比如我们的方法用到特殊的芯片，所以我们需要在方法开头对芯片进行描述。
这里需要采用自顶向底的描述方式，包含哪些组建、组建之间的连接关系，以及每个组件的功能。
我们在上一章节再三强调需要避免的 OOP 的描述方式，恰恰要在这一部分发扬光大，描述方式如下：

* 芯片 A 由子部件 B、C、D 组成，B 由 E、F 组成
* 部件 B 的输入是什么，对数据做什么处理，输出到什么什么
* 部件 C 的输入是什么，对数据做什么处理，输出到什么什么
* 部件 D 的输入是什么，对数据做什么处理，输出到什么什么
* 部件 E 的输入是什么，对数据做什么处理，输出到什么什么
* 部件 F 的输入是什么，对数据做什么处理，输出到什么什么
* ...

这样就详细描述了各个模块的组成，模块的输入输出表示了模块间的连接关系，
对数据做的处理表示了模块的功能，其实也是暗含了 IPO。

然后在开始描述我们的方法流程。而对于虚拟装置，大家尽量用对应的过程描述方式，
比如“编译器”就写编译，“连接器”就写链接。

### 和指导人员的 battle

指导人员其实是很专业和热心的，但是哦们在交流中会存在大量的困惑，就是我们和他们的思考方式狠毒时候是完全不一样的。
我前面的很多论述都是指导老师在帮我改文章的时候，对我的思维方式进行纠正的产物。
比如专利的本质是知识产权，比如要用 IPO 的方式而不是 OOP（当然这位老师不知道 IPO 和 OOP）等等。
但其实严格按照他的要求写，对于我们是存在很大困难的，有的时候是我们的思维无法掉头，
有的时候是我们的语文和哲学能力不过关，有时候是实在没有办法。

比如一切虚拟装置都是不能用来提供处理过程的，那么现在我用仿真器模拟一个硬件模块工作来实现数据处理，
我要怎么描述这个硬件模块？由比如说我用一个神经网络对数据做处理，我要怎么描述这个神经网络？
我们模拟的硬件模块他的设计思路天生就是面向对象的，虽然他在执行的过程中是面向过程的，
但强行按照面向过程写会很麻烦，比计算理论当中描述通用处理器 U 还要麻烦。
它不是对输入做顺序操作的；所有的操作都是一轮一轮并行执行的，而且有复杂的状态机什么的，很麻烦的。
我尽量把这个硬件仿真的过程写的过程化，但是不可避免的掺杂了模块化的语言，他便一个电话过来：

```
他：你怎么还再用模块化的词汇，我们不可以由模块化的，要都过程化的
我：我这个是硬件不能过程化，他和那个软件先这样、再那样不一样的
他：你这个硬件是一个实在的硬件吗？
我：我这个其实是一个处理器，但是是一个仿真的处理器
他：你这个处理器是看得见末的着的真实的硬件，还是电脑里面的软件呢？
我：你要这么说，那确实是电脑里面的软件
他：那不行的，软件就是一个虚拟装置，你必须写成流程化的
```

我说我不知道怎么写成流程化，想要把我的问题详细告诉他，让他指导一下写作。
可以对面在负责人也就是个打工人，他是尽心尽责，但是还是省力省力，
不会设身处地的思考你的难处，也不会主动沉下心来思考你面临的实际问题，
甚至会打断你喋喋不休的描述自己面对的具体问题，
而是用最省力的方法、用他的依赖路径来给你解决问题。
于是就是上文的：我说不知道怎么流程化，你应该要把他们流程化。
我不想流程化呀？我不会呀！

我写一次，他和我说，不行，你这个硬件是软件模拟的，是虚拟装置，不可以写模块化；
可是无论我怎么苦思冥想，搜肠刮肚，我的思维水平也不能帮我把这个过程转化为一个可以简单描述的线性过程。
最后我受不了了，我和他通了个电话，说你的要求我是在满足不了，我的这个硬件是这样子的，我实在是没法按照过程描述。
我逼着他听我说完了我的诉求，每当她想打断我，我就强迫他听我说，最后他终于了解了我的处境说你确实流程化有困难，
那我们还是模块化吧，你把你的硬件描述成装置，然后写在最开头。
这样写法上统一了，后面就写得很快了。

回过头来，还是自己的胆子不够大，主动性不够强，
对于自己的诉求要求不够强烈，在这段合作中关系比较被动。
老师固然是好的，他已经充分尽到自己的义务：
他收到我的专利，马上修改问题，给我打电话，然后告诉我那里需要修改；
我提了问题或者困惑就给我解答，和我说第一次写有问题是正常的，大家一起合作把他写好；
缀词都很礼貌，也没有责怪我傻的意思。
除此之外我想每个人都认为这是自己责任之外的事情了，
他不了解、没有兴趣了解也没有义务我们的工作。
所以他给我提的都是一些普遍性的建议和显而易见的问题，
对于我实际的苦恼，则保持能省力就省力，不会主动深入探索，
也不会站在你的角度、用你计算机人的思维反思问题症结所在。
但这不就是一个正常的成年人改做的事情吗？

所以问题归根结底出现在我自己的身上，作为一个甲方，
作为任务的负责人，我没有把握主动权，我太消极被动了。
对面老师过来，提出意见了，我就好的好的，我去改。
在交流中不好意思打断他，或者不好意思提出我自己的问题，
以至于造成了很长时间的折磨和烦躁，最后逼不得已，
才敢于彻底提出我自己的困难，逼迫他给我提出解决方案。
我甚至不能本能地意识到，这是我作为消费者应该享有的被服务的权利。
我们不能指望别人主动来为我们考虑，不能指望别人主动为我们解决问题，
而是要主动的提出自己的困难，主动让他们采取行动或者提供帮助。
我们的情况我们自己最了解，我们的问题归根结底要靠我们自己解决。

## 专利说明书



